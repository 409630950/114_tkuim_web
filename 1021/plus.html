<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>延伸練習：巢狀條件、多重迴圈、拆函式</title>
  <style>
    body { font-family: system-ui, Segoe UI, Roboto, Noto Sans, sans-serif; padding: 24px; line-height: 1.6; }
    button { padding: 10px 14px; border-radius: 10px; border: 1px solid #ccc; cursor: pointer; }
    pre { background: #f7f7f7; padding: 12px; border-radius: 10px; margin-top: 14px; white-space: pre; }
  </style>
</head>
<body>
  <h1>延伸練習：巢狀條件 + 多重迴圈 + 拆函式</h1>
  <p>按下按鈕開啟多重選單（使用 <code>prompt()</code> / <code>alert()</code>），結果會寫到下面的 <code>&lt;pre&gt;</code>。</p>
  <button onclick="openMainMenu()">開啟多重選單</button>
  <pre id="out">（輸出會顯示在這裡）</pre>

  <script>
    function setOut(text) {
      document.getElementById('out').textContent = text;
    }

    function promptNumber(message, { integer = false, min = -Infinity, max = Infinity } = {}) {
      const raw = prompt(message);
      if (raw === null) return { ok: false, value: NaN };
      const num = Number(raw);
      if (Number.isNaN(num)) return { ok: true, value: NaN };
      if (integer && !Number.isInteger(num)) return { ok: true, value: NaN };
      if (num < min || num > max) return { ok: true, value: NaN };
      return { ok: true, value: num };
    }

    function buildMatrix(r, c, fillFn) {
      const m = new Array(r);
      for (let i = 0; i < r; i++) {
        m[i] = new Array(c);
        for (let j = 0; j < c; j++) {
          m[i][j] = fillFn(i, j);
        }
      }
      return m;
    }

    function matrixToString(M) {
      return M.map(row => row.map(x => String(x).padStart(6, ' ')).join(' ')).join('\n');
    }

    function addMatrix(A, B) {
      const r = A.length, c = A[0].length;
      const C = buildMatrix(r, c, () => 0);
      for (let i = 0; i < r; i++) {
        for (let j = 0; j < c; j++) {
          C[i][j] = A[i][j] + B[i][j];
        }
      }
      return C;
    }

    function multiplyMatrix(A, B) {
      const r = A.length, n = A[0].length, c = B[0].length;
      const C = buildMatrix(r, c, () => 0);
      for (let i = 0; i < r; i++) {
        for (let k = 0; k < n; k++) {
          for (let j = 0; j < c; j++) {
            C[i][j] += A[i][k] * B[k][j];
          }
        }
      }
      return C;
    }

    function openMainMenu() {
      while (true) {
        const mainSel = prompt(
          [
            '請選擇主功能：',
            '1) 乘法表（多重迴圈）',
            '2) 矩陣運算（相加 / 相乘）',
            '3) 數列加總（for / while 範例）',
            '0) 離開'
          ].join('\n')
        );
        if (mainSel === null || mainSel.trim() === '0') { alert('已離開。'); break; }

        switch (mainSel.trim()) {
          case '1':
            submenuMultiplication();
            break;
          case '2':
            submenuMatrix();
            break;
          case '3':
            submenuSeries();
            break;
          default:
            alert('無此選項，請重新輸入。');
        }
      }
    }

    function submenuMultiplication() {
      const nAns = promptNumber('請輸入乘法表大小 N（建議 9 或 12）：', { integer: true, min: 1, max: 30 });
      if (!nAns.ok) return;
      if (Number.isNaN(nAns.value)) { alert('❌ 請輸入 1~30 的整數'); return; }
      const N = nAns.value;

      let out = `乘法表（1~${N}）：\n`;
      for (let i = 1; i <= N; i++) {          
        let row = [];
        for (let j = 1; j <= N; j++) {         
          row.push(String(i * j).padStart(4, ' '));
        }
        out += row.join('') + '\n';
      }
      alert('已在頁面顯示乘法表');
      setOut(out);
    }

   
    function submenuMatrix() {
      const sub = prompt(['矩陣運算：', '1) 矩陣相加', '2) 矩陣相乘', '0) 返回主選單'].join('\n'));
      if (sub === null || sub.trim() === '0') return;

      if (sub.trim() === '1') {
      
        const rAns = promptNumber('矩陣列數 r（1~10）：', { integer: true, min: 1, max: 10 });
        if (!rAns.ok || Number.isNaN(rAns.value)) { alert('❌ 列數無效'); return; }
        const cAns = promptNumber('矩陣行數 c（1~10）：', { integer: true, min: 1, max: 10 });
        if (!cAns.ok || Number.isNaN(cAns.value)) { alert('❌ 行數無效'); return; }
        const r = rAns.value, c = cAns.value;

       
        const A = buildMatrix(r, c, (i, j) => i * c + j + 1);
        const B = buildMatrix(r, c, (i, j) => (i + 1) * (j + 1));
        const C = addMatrix(A, B);

        const text = [
          '矩陣相加示範：',
          'A =\n' + matrixToString(A),
          'B =\n' + matrixToString(B),
          'A + B =\n' + matrixToString(C)
        ].join('\n\n');
        alert('已在頁面顯示矩陣相加結果');
        setOut(text);

      } else if (sub.trim() === '2') {
        
        const rAns = promptNumber('A 的列數 r（1~8）：', { integer: true, min: 1, max: 8 });
        if (!rAns.ok || Number.isNaN(rAns.value)) { alert('❌ r 無效'); return; }
        const nAns = promptNumber('A 的行數 n / B 的列數 n（1~8）：', { integer: true, min: 1, max: 8 });
        if (!nAns.ok || Number.isNaN(nAns.value)) { alert('❌ n 無效'); return; }
        const cAns = promptNumber('B 的行數 c（1~8）：', { integer: true, min: 1, max: 8 });
        if (!cAns.ok || Number.isNaN(cAns.value)) { alert('❌ c 無效'); return; }

        const r = rAns.value, n = nAns.value, c = cAns.value;

       
        const A = buildMatrix(r, n, (i, j) => (i + 1) + (j + 1));          
        const B = buildMatrix(n, c, (i, j) => (i + 1) * (j + 1));
        const C = multiplyMatrix(A, B);

        const text = [
          '矩陣相乘示範：',
          `A (${r}x${n}) =\n` + matrixToString(A),
          `B (${n}x${c}) =\n` + matrixToString(B),
          `A × B (${r}x${c}) =\n` + matrixToString(C)
        ].join('\n\n');
        alert('已在頁面顯示矩陣相乘結果');
        setOut(text);

      } else {
        alert('無此選項');
      }
    }


    function submenuSeries() {
      const sub = prompt(['數列加總：', '1) 1+2+...+N（for）', '2) 奇數和（1+3+...）', '3) while 版本（1~N）', '0) 返回'].join('\n'));
      if (sub === null || sub.trim() === '0') return;

      const nAns = promptNumber('請輸入 N（1~100000）：', { integer: true, min: 1, max: 100000 });
      if (!nAns.ok || Number.isNaN(nAns.value)) { alert('❌ N 無效'); return; }
      const N = nAns.value;

      let sum = 0, detail = '';
      if (sub.trim() === '1') {

        for (let i = 1; i <= N; i++) sum += i;
        detail = `for 迴圈：1..${N} 之和 = ${sum}`;
      } else if (sub.trim() === '2') {
      
        for (let i = 1; i <= N; i += 2) sum += i;
        detail = `for 迴圈：<=${N} 的奇數和 = ${sum}`;
      } else if (sub.trim() === '3') {
    
        let i = 1;
        while (i <= N) { sum += i; i++; }
        detail = `while 迴圈：1..${N} 之和 = ${sum}`;
      } else {
        alert('無此選項');
        return;
      }
      alert('已在頁面顯示數列加總結果');
      setOut(detail);
    }
  </script>
</body>
</html>
